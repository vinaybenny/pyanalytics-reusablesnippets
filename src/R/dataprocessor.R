setwd("/home/vinay/Documents/code/ml_template/src");

library(caret);
library(ggplot2);

# Define dataset level variables here.
dataset <- read.csv("../data/train.csv");
ycol = "Survived";
validation_size <-  0.1;
irrelevant_cols <- c("PassengerId", "Name", "Ticket", "Cabin");

# Data Cleaning
# Drop columns that are not to be used in the model
if (length(irrelevant_cols) > 0) {
  dataset <- dataset[ ,!names(dataset) %in% irrelevant_cols];
}

# Drop NaNs from dataset or impute it.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
dataset <- na.omit(dataset);

# Split labels and covariates into different dataframes.
y <- dataset[ , ycol];

# Convert all categorical covariates into one-hot encoding, remove target
X <- dataset[, !names(dataset) %in% ycol];
X <- model.matrix(~., data=X)[,-1];

# Train-Validation split
train_indices <- createDataPartition(y, times =1, p=(1-validation_size), list=TRUE);
X_train <- X[train_indices$Resample1, ];
y_train <- y[train_indices$Resample1];
X_valid <- X[-train_indices$Resample1, ];
y_valid <- y[-train_indices$Resample1];

# Visualizations



